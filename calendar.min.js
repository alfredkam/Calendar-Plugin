/*
	calendar widget version 0.5
	http://alfredkam.com/projects/Calendar-Plugin/

	use calendar.css for styling
	
	Copyright 2011-2012, Alfred Kam
	Dual licensed under the MIT or GPL Version 2 licenses.
*/
(function(){$.calendar={min:function(c,a){var k=function(){var o="<div class='cal_box_days'>";for(var m=0;m<clang.days.length;m++){o+="<div>"+clang.days[m]+"</div>"}o+="</div>";var n="<div class='mc-box'><div class='cal_box_button'><a href='#cal-left' class='cal_box_left_button'><div>&#60</div></a></div><div id='mc-mid' class='cal_box_cal'><div id='mc-mid-year'></div><div id='mc-mid-month'></div>"+o+"<div id='mc-mid-num' class='cal_box_num'></div><div class='cal_box_button'><a href='#cal-right' class='cal_box_right_button'><div>&#62;</div></a></div></div>";$("#"+c.div).html(n)};var h=function(o,p,m){var n;if(p==2){if(o%4==0&&o%100!=0){n=29}else{n=28}}else{if(p<8){if(p%2==0){n=30}else{n=31}}else{if(p%2==0){n=31}else{n=30}}}if(m<0){return n+m}else{return m}};var g=function(n){return clang.months[n]};var e=function(t){var s=new Date();var p={year:s.getFullYear(),month:s.getMonth(),day:s.getDate()};var m=s.getDate()+t,q=s.getMonth(),n=s.getFullYear();var r=h(n,q,31);if(m-r>0){m-=r;q+=1}var o={year:n,month:q,day:m};return[p,o]};var d=function(u,q,o){var r=new Date(u,q,1);var q=r.getMonth();q+=1;var v=0;var p=r.getDay();var t="";var w=function(z,y){var x;if(z<8){if(z==2){if(y%4==0&&y%100!=0){x=29}else{x=28}}else{if(z%2==0){x=30}else{x=31}}}else{if(z%2==0){x=31}else{x=30}}return x};v=w(q,u);t+="<input type='hidden' value='"+u+"' id='"+(q-1)+"'/><div class='cal_box_week cal_box_week_first'>";var n=p;q-=1;var s=new Date();for(var m=1;m<=v;m++){if(u<s.getFullYear()){t+="<div><a href='#day-past' class='cal_box_past'><div>"+m+"</div></a></div>"}else{if(u==s.getFullYear()&&q<s.getMonth()){t+="<div><a href='#day-past' class='cal_box_past'><div>"+m+"</div></a></div>"}else{if(u==s.getFullYear()&&q==s.getMonth()&&m<s.getDate()){t+="<div><a href='#day-past' class='cal_box_past'><div>"+m+"</div></a></div>"}else{if(q==s.getMonth()&&u==s.getFullYear()&&m==s.getDate()){t+="<div><a href='#day-to' class='cal_box_day cal_box_today'><div>"+m+"</div></a></div>"}else{if(q==j[0].month&&u==j[0].year&&m==j[0].day){t+="<div><a href='#day-to' class='cal_box_day cal_box_select'><div>"+m+"</div></a></div>"}else{t+="<div><a href='#day-to' class='cal_box_day'><div>"+m+"</div></a></div>"}}}}}if(n!=0&&(n+1)%7==0){t+="</div><div class='cal_box_week'>"}n+=1}return t+"</div>"};clang=[];clang.months=a.calendar.months;clang.days=a.calendar.days;k();var b=[{},{}];if(c.defaultStartDate!=undefined){b[1].day=c.defaultStartDate.day;b[1].month=c.defaultStartDate.month;b[1].year=c.defaultStartDate.year}else{if(c.range==undefined){b=e(0)}else{b=e(c.range)}}var j=b.slice(0);j[0].day=j[1].day;j[0].month=j[1].month;j[0].year=j[1].year;var l=b[1];var i=d(b[1].year,b[1].month,b);$("#"+c.div+" #mc-mid-year").html(b[1].year);$("#"+c.div+" #mc-mid-month").html(g(b[1].month));$("#"+c.div+" #mc-mid-num").html(i);c.changeRange(b[1]);var f=function(){$("#"+c.div+" .cal_box_day").click(function(){var m=$(this).children().text();var o,n;$(this).parent().parent().parent().children().each(function(){if($(this).attr("type")=="hidden"){o=$(this).attr("id");n=$(this).attr("value")}});b[1].day=m;b[1].year=n;b[1].month=o;j[0].day=m;j[0].year=n;j[0].month=o;var p=d(l.year,l.month,b);$("#"+c.div+" #mc-mid-year").html(l.year);$("#"+c.div+" #mc-mid-month").html(g(l.month));$("#"+c.div+" #mc-mid-num").html(p);c.changeRange(b[1]);f()})};$("#"+c.div+" .cal_box_left_button").click(function(){if(parseInt(l.month)-1<0){l.month=11;l.year=parseInt(l.year)-1}else{l.month=parseInt(l.month)-1}var m=d(l.year,l.month,b);$("#"+c.div+" #mc-mid-year").html(l.year);$("#"+c.div+" #mc-mid-month").html(g(l.month));$("#"+c.div+" #mc-mid-num").html(m);f()});$("#"+c.div+" .cal_box_right_button").click(function(){if(parseInt(l.month)+1>11){l.month=0;l.year=parseInt(l.year)+1}else{l.month=parseInt(l.month)+1}var m=d(l.year,l.month,b);$("#"+c.div+" #mc-mid-year").html(l.year);$("#"+c.div+" #mc-mid-month").html(g(l.month));$("#"+c.div+" #mc-mid-num").html(m);f()});f()},full:function(d,c){var l=function(){var q="<div class='cal_box_days'>";for(var o=0;o<clang.days.length;o++){q+="<div>"+clang.days[o]+"</div>"}q+="</div>";var p="<div class='cal_box'><div class='cal_box_button'><a href='#cal-left' class='cal_box_left_button'><div>&#60</div></a></div><div id='cal_box_left' class='cal_box_cal'><div id='cal_box_left_year'></div><div id='cal_box_left_month'></div>"+q+"<div id='cal_box_left_num' class='cal_box_num'></div></div><div id='cal_box_mid' class='cal_box_cal'><div id='cal_box_mid_year'></div><div id='cal_box_mid_month'></div>"+q+"<div id='cal_box_mid_num' class='cal_box_num'></div></div><div id='cal_box_right' class='cal_box_cal'><div id='cal_box_right_year'></div><div id='cal_box_right_month'></div>"+q+"<div id='cal_box_right_num' class='cal_box_num'></div></div><div class='cal_box_button'><a href='#cal-right' class='cal_box_right_button'><div>&#62;</div></a></div><div id='cal_box_settings' class='cal_box_cal'></div></div>";$("#"+d.div).html(p);n()};var n=function(){var o="<div class='cal_box_settings_header'><div>Custom Range</div><div id='cal_box_custom_range_div'><select id='cal_box_custom_range'>";o+="<option value='7'>"+c.calendar["7days"]+"</option><option value='30' selected='selected'>"+c.calendar["30days"]+"</option><option value='90'>"+c.calendar["90days"]+"</option><option value='custom'>"+c.calendar.custom+"</option></select></div></div>";o+="<div class='cal_inputbox'><input type='text' id='cal_inputbox_1'/> to <input type='text' id='cal_inputbox_2'/></div>";o+="<div><a href='#cal-apply' id='cal_apply'><div>Apply</div></a><a href='#cal-cancel' id='cal_cancel'><div>Cancel</div></a></div>";$("#"+d.div+" #cal_box_settings").html(o)};var e=function(z,v,r,q){var w=new Date(z,v,1);var v=w.getMonth();v+=1;var C=0;var u=w.getDay();var y="";var B=function(F,E){var D;if(F<8){if(F==2){if(E%4==0&&E%100!=0){D=29}else{D=28}}else{if(F%2==0){D=30}else{D=31}}}else{if(F%2==0){D=31}else{D=30}}return D};C=B(v,z);var p=B(r.month+1,r.year);var o=B(q.month+1,q.year);if(p<r.day){r.day=p}if(o<q.day){q.day=o}if(r.year<q.year){var A=q;q=r;r=A}else{if(r.year==q.year&&r.month<q.month){var A=q;q=r;r=A}else{if(r.year==q.year&&r.month==q.month&&r.day<q.day){var A=q;q=r;r=A}}}f.range[0]=r;f.range[1]=q;var x=new Date();y+="<input type='hidden' value='"+z+"' id='"+(v-1)+"'/><div class='cal_box_week cal_box_week_first'>";var t=u;for(var s=1;s<=C;s++){if(z>r.year){y+="<div><a href='#cal-day' class='cal_box_past'><div>"+s+"</div></a></div>"}else{if(z==x.getFullYear()&&v-1==x.getMonth()&&s>x.getDate()){y+="<div><a href='#cal-day' class='cal_box_past'><div>"+s+"</div></a></div>"}else{if(z==x.getFullYear()&&v-1>x.getMonth()){y+="<div><a href='#cal-day' class='cal_box_past'><div>"+s+"</div></a></div>"}else{if(q.year<=z&&z<=r.year){if(r.year-q.year==0){if(q.month<=v-1&&v-1<=r.month){if(r.month==q.month&&r.month==v-1){if(q.day<=s&&s<=r.day){y+="<div><a href='#cal-day' class='cal_box_day cal_box_day_select'><div>"+s+"</div></a></div>"}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}else{if(q.month==v-1&&s>=q.day){y+="<div><a href='#cal-day' class='cal_box_day cal_box_day_select'><div>"+s+"</div></a></div>"}else{if(r.month==v-1&&s<=r.day){y+="<div><a href='#cal-day' class='cal_box_day cal_box_day_select'><div>"+s+"</div></a></div>"}else{if(q.month!=v-1&&r.month!=v-1){y+="<div><a href='#cal-day' class='cal_box_day cal_box_day_select'><div>"+s+"</div></a></div>"}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}}}}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}else{if(r.year-q.year==1){if(q.year==z){if(q.month<=v-1){if(q.month==v-1&&s>=q.day){y+="<div><a href='#cal-day' class='cal_box_day cal_box_day_select'><div>"+s+"</div></a></div>"}else{if(q.month!=v-1){y+="<div><a href='#cal-day' class='cal_box_day cal_box_day_select'><div>"+s+"</div></a></div>"}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}else{if(v-1<=r.month){if(r.month==v-1&&s<=r.day){y+="<div><a href='#cal-day' class='cal_box_day cal_box_day_select'><div>"+s+"</div></a></div>"}else{if(r.month!=v-1){y+="<div><a href='#cal-day' class='cal_box_day cal_box_day_select'><div>"+s+"</div></a></div>"}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}}else{y+="<div><a href='#cal-day' class='cal_box_day'><div>"+s+"</div></a></div>"}}}}if(t!=0&&(t+1)%7==0){y+="</div><div class='cal_box_week'>"}t+=1}y+="</div>";return y};clang=[];clang.months=c.calendar.months;clang.days=c.calendar.days;clang["move back month"]=c.calendar.move_back_m;clang["move forward month"]=c.calendar.move_for_m;clang["move back year"]=c.calendar.move_back_year;clang["move forward year"]=c.calendar.move_for_year;var j=function(q,r,o){var p;if(r==2){if(q%4==0&&q%100!=0){p=29}else{p=28}}else{if(r<8){if(r%2==0){p=30}else{p=31}}else{if(r%2==0){p=31}else{p=30}}}if(o<0){return p+o}else{return o}};var i=function(o){return clang.months[o]};var h=function(u){var t=new Date();var r={year:t.getFullYear(),month:t.getMonth(),day:t.getDate()};var o=t.getDate()-u,s=t.getMonth(),p=t.getFullYear();while(o<=0){s-=1;if(s<0){s=11;p-=1}o+=j(p,s,31)}var q={year:p,month:s,day:o};return[r,q]};var b=function(s,u){var t="",o="",p="";var q=u;p=e(s.year,s.month,q[0],q[1]);$("#"+d.div+" #cal_box_right_month").html(i(s.month));$("#"+d.div+" #cal_box_right_year").html(s.year);if(s.month-1<0){o=e(s.year-1,11,q[0],q[1]);$("#"+d.div+" #cal_box_mid_month").html(i(11));$("#"+d.div+" #cal_box_mid_year").html(s.year-1);t=e(s.year-1,10,q[0],q[1]);$("#"+d.div+" #cal_box_left_month").html(i(10));$("#"+d.div+" #cal_box_left_year").html(s.year-1)}else{o=e(s.year,s.month-1,q[0],q[1]);$("#"+d.div+" #cal_box_mid_month").html(i(s.month-1));$("#"+d.div+" #cal_box_mid_year").html(s.year);if(s.month-2<0){t=e(s.year-1,11,q[0],q[1]);$("#"+d.div+" #cal_box_left_month").html(i(11));$("#"+d.div+" #cal_box_left_year").html(s.year-1)}else{t=e(s.year,s.month-2,q[0],q[1]);$("#"+d.div+" #cal_box_left_month").html(i(s.month-2));$("#"+d.div+" #cal_box_left_year").html(s.year)}}$("#"+d.div+" #cal_box_mid_num").html(o);$("#"+d.div+" #cal_box_left_num").html(t);$("#"+d.div+" #cal_box_right_num").html(p);$("#"+d.div+" #cal_inputbox_1").val(f.range[1].year+"-"+(parseInt(f.range[1].month)+1)+"-"+f.range[1].day);$("#"+d.div+" #cal_inputbox_2").val(f.range[0].year+"-"+(parseInt(f.range[0].month)+1)+"-"+f.range[0].day);g()};var g=function(){$("#"+d.div+" .cal_box_day").click(function(){var o=$(this).children().text();$(this).parent().parent().parent().children().each(function(){if($(this).attr("type")=="hidden"){var q=$(this).attr("id");var p=$(this).attr("value");if(a==0){$("#"+d.div+" #cal_inputbox_1").val($(this).children().html());$("#"+d.div+" #cal_inputbox_1").addClass("cal_focus");$("#"+d.div+" #cal_inputbox_2").removeClass("cal_focus");$("#"+d.div+" #cal_inputbox_1").val(p+"-"+(parseInt(q)+1)+"-"+o);f.range[1].year=p;f.range[1].month=q;f.range[1].day=o;b(f,f.range)}else{$("#"+d.div+" #cal_inputbox_2").val($(this).children().html());$("#"+d.div+" #cal_inputbox_2").addClass("cal_focus");$("#"+d.div+" #cal_inputbox_1").removeClass("cal_focus");$("#"+d.div+" #cal_inputbox_2").val(p+"-"+(parseInt(q)+1)+"-"+o);f.range[0].year=p;f.range[0].month=q;f.range[0].day=o;b(f,f.range)}}});$("#"+d.div+" #cal_box_custom_range option").each(function(){$(this).attr("selected","false");if($(this).val()=="custom"){$(this).attr("selected","true")}})})};var a=0;var k=function(){$("#"+d.div+" #cal_box_custom_range").change(function(){$("#"+d.div+" #cal_box_custom_range option:selected").each(function(){if($(this).attr("value")=="custom"){}else{b(f,h($(this).attr("value")));f.range=h($(this).attr("value"));var o=f.range;$("#"+d.div+" #cal_inputbox_1").val(o[1].year+"-"+(o[1].month+1)+"-"+o[1].day);$("#"+d.div+" #cal_inputbox_2").val(o[0].year+"-"+(o[0].month+1)+"-"+o[0].day)}})});$("#"+d.div+" .cal_box_right_button").click(function(){f.month+=1;if(f.month>11){f.month=0;f.year+=1}b(f,f.range)});$("#"+d.div+" .cal_box_left_button").click(function(){f.month-=1;if(f.month<0){f.month=11;f.year-=1}b(f,f.range)});$("#"+d.div+" #cal_inputbox_1").click(function(){a=0;$(this).addClass("cal_focus");$("#"+d.div+" #cal_inputbox_2").removeClass("cal_focus");$("#"+d.div+" #cal_box_custom_range option").each(function(){$(this).attr("selected","false");if($(this).val()=="custom"){$(this).attr("selected","true")}})}).keyup(function(){var p=$(this).val().split("-");if(p.length!=3){$(this).addClass("cal_input_bug")}else{$(this).removeClass("cal_input_bug");for(var o=0;o<p.length;o++){if(isNaN(p[o])){$(this).addClass("cal_input_bug");return}}$(this).removeClass("cal_input_bug");if(2000<=parseInt(p[0])&&parseInt(p[0])<=2100&&1<=parseInt(p[1])&&parseInt(p[1])<=12&&1<=parseInt(p[2])&&parseInt(p[2])<=31){$(this).removeClass("cal_input_bug");f.range[1].year=p[0];f.range[1].month=p[1]-1;f.range[1].day=p[2];b(f,f.range)}else{$(this).addClass("cal_input_bug")}}});$("#"+d.div+" #cal_inputbox_2").click(function(){a=1;$(this).addClass("cal_focus");$("#"+d.div+" #cal_inputbox_1").removeClass("cal_focus");$("#"+d.div+" #cal_box_custom_range option").each(function(){$(this).attr("selected","false");if($(this).val()=="custom"){$(this).attr("selected","true")}})}).keyup(function(){var p=$(this).val().split("-");if(p.length!=3){$(this).addClass("cal_input_bug")}else{$(this).removeClass("cal_input_bug");for(var o=0;o<p.length;o++){if(isNaN(p[o])){$(this).addClass("cal_input_bug");return}}$(this).removeClass("cal_input_bug");if(2000<=parseInt(p[0])&&parseInt(p[0])<=2100&&1<=parseInt(p[1])&&parseInt(p[1])<=12&&1<=parseInt(p[2])&&parseInt(p[2])<=31){$(this).removeClass("cal_input_bug");f.range[0].year=p[0];f.range[0].month=p[1]-1;f.range[0].day=p[2];b(f,f.range)}else{$(this).addClass("cal_input_bug")}}});$("#"+d.div+" #cal_apply").click(function(){d.range=f.range;d.changeRange(f.range);try{d.apply()}catch(o){}});$("#"+d.div+" #cal_cancel").click(function(){$("#"+d.div+" #cal_box_custom_range option").each(function(){$(this).attr("selected","false");if($(this).val()=="custom"){$(this).attr("selected","true")}});b(d.defaultStartDate,d.range)})};l();d.range=h(30);var f=d.defaultStartDate;f.range=h(30);b(d.defaultStartDate,h(30));f.days=30;d.changeRange(f.range);$("#"+d.div+" #cal_inputbox_1").addClass("cal_focus");var m=f.range;$("#"+d.div+" #cal_inputbox_1").val(m[1].year+"-"+(m[1].month+1)+"-"+m[1].day);$("#"+d.div+" #cal_inputbox_2").val(m[0].year+"-"+(m[0].month+1)+"-"+m[0].day);k()}}})();
